<% label = target.try(:roles) ? target.roles.first.name.to_s : target.class.to_s %>
<% opt = opt.present? ? opt : nil %>

<% if opt && opt[:classes] %>
  <% classes = opt[:classes] %>
<% else %>
  <% classes = 'follow-button' %>
<% end %>

<% if opt && opt[:text] %>
  <% text = opt[:text] %>
<% else %>
  <% text = ['follow','unfollow'] %>
<% end %>


<% if current_user.nil? %>

  &nbsp;

<% elsif current_user.followed(target) %>

  <%= render partial: 'follows/unfollow', 
      locals: { target: target, text: text, classes: classes } %>

<% elsif target == current_user %>
  
<% else %>

  <%= render partial: 'follows/follow', 
      locals: { target: target, text: text, classes: classes } %>

<% end %>
